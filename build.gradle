buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'info.solidsoft.gradle.pitest:gradle-pitest-plugin:1.1.10'
    }
}

apply plugin: 'info.solidsoft.pitest'
apply plugin: 'java'
apply plugin: 'application'

sourceCompatibility = JavaVersion.VERSION_1_8
targetCompatibility = JavaVersion.VERSION_1_8
compileJava.options.encoding = 'UTF-8'
compileJava.options.compilerArgs << "-Xlint:all"
javadoc.options.encoding = 'UTF-8'

repositories {
    flatDir {
        dirs 'libs'
    }
}

dependencies {

    testCompile 'junit:junit:4.12'
    testCompile 'org.hamcrest:hamcrest-core:1.3'

    testCompile 'org.assertj:assertj-core:3.6.2'

    testCompile 'org.mockito:mockito-core:2.7.22'
    testCompile 'net.bytebuddy:byte-buddy:1.6.11'
    testCompile 'net.bytebuddy:byte-buddy-agent:1.6.11'
    testCompile 'org.objenesis:objenesis:2.5'
}

tasks.withType(JavaCompile) {
    options.incremental = true
}

tasks.matching { it instanceof Test }.all {
    testLogging.events = ["failed", "passed", "skipped"]
}

mainClassName = 'ee.larseckart.logstats.Main'

jar {
    manifest {
        attributes(
                'Main-Class': 'ee.larseckart.logstats.Main'
        )
    }
}

pitest {
    targetClasses = ['ee.larseckart.*']
    testSourceSets = [sourceSets.test,]
    pitestVersion = "1.1.5"
    threads = 4
    outputFormats = ['HTML']
    enableDefaultIncrementalAnalysis = true
}
