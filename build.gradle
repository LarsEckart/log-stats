buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'info.solidsoft.gradle.pitest:gradle-pitest-plugin:1.1.10'
    }
}

plugins {
    id "net.ltgt.apt" version "0.18"
}

apply plugin: 'info.solidsoft.pitest'
apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'idea'

sourceCompatibility = JavaVersion.VERSION_1_8
targetCompatibility = JavaVersion.VERSION_1_8
compileJava.options.encoding = 'UTF-8'
compileJava.options.compilerArgs << "-Xlint:all"
javadoc.options.encoding = 'UTF-8'

repositories {
    jcenter()
}

dependencies {
    annotationProcessor "io.micronaut:micronaut-inject-java:1.0.3"
    compile "io.micronaut:micronaut-inject:1.0.3"
    compile 'ch.qos.logback:logback-classic:1.2.3'


    testCompile 'junit:junit:4.12'
    testCompile 'org.assertj:assertj-core:3.8.0'
    testCompile 'org.mockito:mockito-core:2.10.0'
}

tasks.withType(JavaCompile) {
    options.incremental = true
}

tasks.matching { it instanceof Test }.all {
    testLogging.events = ["failed", "passed", "skipped"]
}

mainClassName = 'ee.larseckart.logstats.Main'

jar {
    manifest {
        attributes(
                'Main-Class': 'ee.larseckart.logstats.Main'
        )
    }
}

pitest {
    targetClasses = ['ee.larseckart.*']
    testSourceSets = [sourceSets.test,]
    pitestVersion = "1.1.5"
    threads = 4
    outputFormats = ['HTML']
    enableDefaultIncrementalAnalysis = true
}
